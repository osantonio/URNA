<!-- ./app/templates/base.html -->
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}URNA{% endblock %} - Sistema Electoral</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', path='/favicon.ico') }}">

    <!-- Script crítico para dark mode (debe ejecutarse antes del render para evitar flash) -->
    <script>
        // Flowbite-style dark mode handler
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.setAttribute('data-theme', 'dark');
        } else {
            document.documentElement.setAttribute('data-theme', 'light');
        }
    </script>

    <!-- Tailwind CSS compilado -->
    <link rel="stylesheet" href="{{ url_for('static', path='/css/output.css') }}">

    {% block extra_css %}{% endblock %}
</head>

<body class="bg-background text-foreground transition-colors duration-300">
    <!-- Navbar modular -->
    {% include "componentes/navbar.html" %}

    <!-- Contenido principal -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!--
        Configuración exclusiva de Mensajes Flash
        Paleta: usa `--color-primary` y `--color-primary-foreground` para alto contraste
        Propósito: contenedor al final del documento, sin posición fija, evita superposición
        Nota: mantener estilos y clases separados del tema principal para modularidad
    -->
    {% if messages %}
    <div class="flash-container" role="status" aria-live="polite">
        {% for message in messages %}
        <div class="flash-badge">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Scripts de interactividad -->
    <script src="{{ url_for('static', path='/js/font-geist.js') }}"></script>
    <script src="{{ url_for('static', path='/js/dark-mode.js') }}"></script>
    <script src="{{ url_for('static', path='/js/dropdown-perfil.js') }}"></script>

    {% block extra_js %}{% endblock %}
</body>

</html>
